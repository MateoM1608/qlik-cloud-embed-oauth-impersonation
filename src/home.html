<DOCTYPE html>
  <html lang="en">

  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- <meta name="description" content="" /> -->
    <!-- <meta name="author" content="" /> -->
    <!-- <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" /> -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" /> -->
    <!-- <link href="css/styles.css" rel="stylesheet" /> -->
    <!-- <link href="css/qlik-embed-style.css" rel="stylesheet" /> -->
    <!-- <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script> -->
    <script src="js/script.js"></script>
  </head>

  <body>
    <div>
      <qlik-embed ui="classic/app" app-id="" sheet-id=""></qlik-embed>
    </div>

    <script type="module">
      async function updateHeaders(configParams) {
        var qlik_embed_script = document.createElement('script');
        qlik_embed_script.setAttribute('crossorigin', 'anonymous');
        qlik_embed_script.setAttribute('type', 'application/javascript');
        qlik_embed_script.setAttribute('src', 'https://cdn.jsdelivr.net/npm/@qlik/embed-web-components@1/dist/index.min.js');
        qlik_embed_script.setAttribute('data-host', 'fga.us.qlikcloud.com');
        qlik_embed_script.setAttribute('data-client-id', 'e55e98c511fe13666d32d1e2fa1c6dff');
        qlik_embed_script.setAttribute('data-get-access-token', 'getAccessToken');
        qlik_embed_script.setAttribute('data-auth-type', 'OAuth2');
        await document.head.appendChild(qlik_embed_script);
      }

      async function updateQlikEmbedTags(configParams) {
        const qeObjects = document.querySelectorAll('qlik-embed');
        for (var i = 0; i < qeObjects.length; i++) {
          qeObjects[i].setAttribute('app-id', configParams.appId);
          qeObjects[i].setAttribute('sheet-id', configParams.sheetId);
        }
      }

      document.addEventListener("DOMContentLoaded", async () => {
        // var configParams = JSON.parse(await getConfigParameter());
//        var configParams = {
//          tenantUri: "fga.us.qlikcloud.com",
//          oAuthFrontEndClientId: "e55e98c511fe13666d32d1e2fa1c6dff",
//          appId: "d496e34e-d5e4-4950-8881-dd936eabe16e",
//          sheetId: "BfUaP",
//          objectId: "BfUaP",
//          fieldId: "City"
//        }
        var configParams = {
          tenantUri: "fga.us.qlikcloud.com",
          oAuthFrontEndClientId: "e55e98c511fe13666d32d1e2fa1c6dff",
          appId: "a496d362-4b4d-471e-ba32-b3277f5f50c9",
          sheetId: "f58beb8d-8df7-405d-945d-0da40a54c648",
          objectId: "f58beb8d-8df7-405d-945d-0da40a54c648",
          fieldId: "City"
        }
        await updateQlikEmbedTags(configParams);
        await updateHeaders(configParams);
      });
    </script>
  </body>
  </html>